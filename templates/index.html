<!-- templates/index.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nega's Butchery - Product Reservations</title>
    <!-- Tailwind CSS CDN for quick styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Font: Inter for a modern look -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* Custom CSS for body and flash messages */
        body {
            font-family: 'Inter', sans-serif;
            /* Elegant split background: Dark blue-charcoal on left, deep maroon on right */
            background: linear-gradient(to right, #1a202c 50%, #6b0000 50%);
            color: #374151; /* Dark gray text */
        }
        .container {
            max-width: 800px;
            margin: 2rem auto; /* Center the container with vertical margin */
            padding: 2rem;
            /* Changed background to a fading dark blue gradient for elegance */
            background: linear-gradient(to bottom, #2c3e50, #34495e); /* From deeper blue to lighter blue */
            border-radius: 0.75rem; /* Rounded corners */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* Subtle shadow */
        }
        .flash-message {
            padding: 0.75rem 1.25rem;
            margin-bottom: 1rem;
            border-radius: 0.5rem;
            font-weight: 600;
        }
        /* Specific styles for different flash message categories */
        .flash-success {
            background-color: #d1fae5; /* Light green */
            color: #065f46; /* Dark green text */
        }
        .flash-error {
            background-color: #fee2e2; /* Light red */
            color: #991b1b; /* Dark red text */
        }
        .flash-info {
            background-color: #e0f2fe; /* Light blue */
            color: #0c4a6e; /* Dark blue text */
        }
    </style>
</head>
<body class="flex flex-col min-h-screen">
    <!-- Header Section -->
    <header class="bg-stone-900 text-white p-4 shadow-md"> <!-- Dark stone gray header -->
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-3xl font-bold text-white">Nega's Butchery</h1>
            <!-- Navigation buttons always visible -->
            <nav class="flex space-x-4">
                <a href="{{ url_for('index') }}" class="bg-stone-700 hover:bg-stone-800 text-white font-bold py-2 px-4 rounded-md transition duration-300 ease-in-out">Home</a>
                <a href="{{ url_for('admin_panel') }}" class="bg-stone-700 hover:bg-stone-800 text-white font-bold py-2 px-4 rounded-md transition duration-300 ease-in-out">Admin Panel</a>
            </nav>
        </div>
    </header>

    <!-- Main Content Area -->
    <main class="flex-grow">
        <div class="container mt-8 text-center">
            <!-- Logo -->
            <img src="{{ url_for('static', filename='nega_logo.png') }}" alt="Nega's Butchery Logo" class="mx-auto mb-6 shadow-lg h-40 w-auto object-contain">

            <!-- Tagline -->
            <p class="text-xl font-semibold text-stone-700 mb-8">
                Locally sourced, traditionally prepared. Get notified when fresh cuts become available for pre-order.
            </p>

            <h2 class="text-3xl font-bold text-indigo-700 text-center mb-6">Get Notified When Available!</h2>

            <!-- Flash Messages Display Area -->
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    <div class="mb-4">
                        {% for category, message in messages %}
                            <div class="flash-message flash-{{ category }}">{{ message }}</div>
                        {% endfor %}
                    </div>
                {% endif %}
            {% endwith %}

            <!-- Subscription Form -->
            <form action="{{ url_for('index') }}" method="POST" class="bg-gray-50 p-6 rounded-lg shadow-inner">
                <div class="mb-6">
                    <label for="product_id" class="block text-gray-700 text-sm font-bold mb-2">Select Product:</label>
                    <select id="product_id" name="product_id" required
                            class="shadow appearance-none border rounded-lg w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent bg-white">
                        <option value="">-- Choose a Product --</option>
                        <!-- Loop through products passed from the Flask backend -->
                        {% for product in products %}
                            <option value="{{ product['id'] }}">{{ product['name'] }} {% if product['is_available'] %}(Available Now!){% else %}(Coming Soon){% endif %}</option>
                        {% endfor %}
                    </select>
                </div>

                <!-- Notification Preference Section -->
                <div class="mb-6">
                    <label class="block text-gray-700 text-sm font-bold mb-2">How would you like to be notified?</label>
                    <div class="mt-2 flex flex-wrap justify-center gap-4">
                        <label class="inline-flex items-center">
                            <input type="radio" class="form-radio text-indigo-600 notification-radio" name="notification_type" value="email" checked required>
                            <span class="ml-2 text-gray-700">Email</span>
                        </label>
                        <label class="inline-flex items-center">
                            <input type="radio" class="form-radio text-indigo-600 notification-radio" name="notification_type" value="phone" required>
                            <span class="ml-2 text-gray-700">Phone (SMS/Call)</span>
                        </label>
                        <label class="inline-flex items-center">
                            <input type="radio" class="form-radio text-indigo-600 notification-radio" name="notification_type" value="both" required>
                            <span class="ml-2 text-gray-700">Both</span>
                        </label>
                    </div>
                </div>

                <!-- Dynamic Input Fields based on Notification Type -->
                <div id="email-input-group" class="mb-4">
                    <label for="email" class="block text-gray-700 text-sm font-bold mb-2">Your Email:</label>
                    <input type="email" id="email" name="email" required
                           class="shadow appearance-none border rounded-lg w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                </div>

                <div id="phone-input-group" class="mb-4 hidden">
                    <label for="phone" class="block text-gray-700 text-sm font-bold mb-2">Your Phone Number:</label>
                    <input type="tel" id="phone" name="phone"
                           class="shadow appearance-none border rounded-lg w-full py-3 px-4 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                </div>

                <div class="flex justify-center">
                    <button type="submit"
                            class="bg-red-800 hover:bg-red-900 text-white font-bold py-3 px-6 rounded-full focus:outline-none focus:shadow-outline transition duration-300 ease-in-out transform hover:scale-105 shadow-lg">
                        Notify Me!
                    </button>
                </div>
            </form>

            <div class="mt-8 text-center text-gray-500 text-sm">
                <p>We'll send you an email/phone notification the moment your selected product becomes available!</p>
            </div>
        </div>
    </main>

    <!-- Footer Section -->
    <footer class="bg-gray-800 text-white text-center p-4 mt-8">
        <p>&copy; 2025 Nega's Butchery. All rights reserved.</p>
    </footer>

    <!-- JavaScript for dynamic input field visibility -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const emailInputGroup = document.getElementById('email-input-group');
            const phoneInputGroup = document.getElementById('phone-input-group');
            const emailInput = document.getElementById('email');
            const phoneInput = document.getElementById('phone');
            const notificationRadios = document.querySelectorAll('.notification-radio');

            function updateInputVisibility() {
                const selectedType = document.querySelector('input[name="notification_type"]:checked').value;

                // Reset required attributes
                emailInput.removeAttribute('required');
                phoneInput.removeAttribute('required');

                if (selectedType === 'email') {
                    emailInputGroup.classList.remove('hidden');
                    phoneInputGroup.classList.add('hidden');
                    emailInput.setAttribute('required', 'true');
                } else if (selectedType === 'phone') {
                    emailInputGroup.classList.add('hidden');
                    phoneInputGroup.classList.remove('hidden');
                    phoneInput.setAttribute('required', 'true');
                } else if (selectedType === 'both') {
                    emailInputGroup.classList.remove('hidden');
                    phoneInputGroup.classList.remove('hidden');
                    emailInput.setAttribute('required', 'true');
                    phoneInput.setAttribute('required', 'true');
                }
            }

            // Add event listeners to radio buttons
            notificationRadios.forEach(radio => {
                radio.addEventListener('change', updateInputVisibility);
            });

            // Initial call to set correct visibility on page load
            updateInputVisibility();
        });
    </script>
</body>
</html>
